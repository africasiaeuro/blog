<!DOCTYPE html>
<html lang="en">
<head>
        <title>Hostout rules</title>
        <meta charset="utf-8" />
        <link rel="stylesheet" href="../../../../../theme/css/main.css" type="text/css" />
                <link href="http://aclark.net/blog/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="Alex Clark - Python Web Developer Atom Feed" />
                
        <!--[if IE]>
                <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->

        <!--[if lte IE 7]>
                <link rel="stylesheet" type="text/css" media="all" href="../../../../../css/ie.css"/>
                <script src="../../../../../js/IE8.js" type="text/javascript"></script><![endif]-->

        <!--[if lt IE 7]>
                <link rel="stylesheet" type="text/css" media="all" href="../../../../../css/ie6.css"/><![endif]-->

</head>

<body id="index" class="home">
<a href="https://github.com/ACLARKNET/blog">
<img style="position: absolute; top: 0; right: 0; border: 0;" src="http://s3.amazonaws.com/github/ribbons/forkme_right_red_aa0000.png" alt="Fork me on GitHub" />
</a>
        <header id="banner" class="body">
                <h1><a href="../../../../..">Alex Clark - Python Web Developer </a></h1>
                <nav><ul>
                                                                                                    <li class="active"><a href="../../../../../category/blog.html">Blog</a></li>
                                </ul></nav>
        </header><!-- /#banner -->
        <section id="content" class="body">
  <article>
    <header>
      <h1 class="entry-title">
        <a href="2011/01/26/hostout-rules/" rel="bookmark"
           title="Permalink to Hostout rules">Hostout rules</a></h1>
      <a href="http://twitter.com/share" class="twitter-share-button" data-count="horizontal" data-via="aclark4life">Tweet</a><script type="text/javascript" src="http://platform.twitter.com/widgets.js"></script>
    </header>

    <div class="entry-content">
      <footer class="post-info">
        <abbr class="published" title="2011-01-26T15:17:00">
                Wed 26 January 2011
        </abbr>

                <address class="vcard author">
                By <a class="url fn" href="../../../../../author/aclark.html">aclark</a>
        </address>
        <p>In <a href="../../../../../category/blog.html">Blog</a>. </p>
<p>tags: <a href="../../../../../tag/plone.html">Plone</a></p></footer><!-- /.post-info -->      <p><em>As in &quot;dominates&quot;, not a &quot;list of rules&quot; :-)</em></p>
<p>I spent a long time avoiding <a class="reference external" href="http://pypi.python.org/pypi/collective.hostout">collective.hostout</a> for reasons I will
call &quot;technical stylistic differences&quot; with the author Dylan Jay.</p>
<p>But then I grew up (and in cases of Plone growth like this, I usually
end up crediting the probably-much-younger-than-me-in-years,
but-certainly-much-more-possessive-of-sage-like-wisdom-than-me-Martin-Aspeli;
and this time is certainly no exception. So thanks Martin!)</p>
<p>As it turns out, Hostout (as I like to call it now, because we are on a
first name basis) is awesome! Let me break down the awesomeness for you.</p>
<div class="section" id="buildout">
<h2>Buildout</h2>
<p>It starts with Buildout. I won't bore you with the details of why
Buildout is awesome, but I will mention one key feature:</p>
<ul class="simple">
<li>INI-style configuration, y'all.</li>
</ul>
<p>Sometimes you just want to specify something like:</p>
<pre class="literal-block">
[foo]
bar = baz
</pre>
<p>and be done. I am not making this up folks. There is something about
INI-style configuration that transcends time and space, and reaches
across partisan-aisles to bring folks together in a &quot;let's just get this
done&quot; sort of way. Of course not everyone likes them, but if you are a
technical person and don't like them, I guarantee you at least
understand them and can see why they might be appropriate in some cases
over another technology.</p>
<p>Anyway, back to the awesomeness.</p>
</div>
<div class="section" id="fabric">
<h2>Fabric</h2>
<p>Fabric is awesome! I won't bore you with the details of why Fabric is
awesome. But I will mention one key feature:</p>
<ul class="simple">
<li>SSH, people. SSH.</li>
</ul>
<p>Sometimes you just want to type:</p>
<pre class="literal-block">
$ fab -H foo.com bar
</pre>
<p>and be done. Fabric lets you execute the Python code you wrote in a
function called &quot;bar&quot;, inside a (local) file called fabfile.py, on a
(remote) host called foo.com. All with the touch of a button, so to
speak. That is to say, you create a local fabfile.py file, and Fabric
runs the code remotely for you on any number of hosts you give it.
Brilliant.</p>
<p>Now, what could be better than these two technologies? These two
technologies <em>together</em>, that's what. (See where I am going with this?)
And what could be better than joining these two technologies? Joining
them with <em>absolutely no effort required on your part whatsoever</em>,
that's what.</p>
<p>I have a long history of touting software that makes my job (and life)
easier, and Hostout fits right in with that tradition. I'm just sorry it
took me this long to try it out.</p>
</div>
<div class="section" id="hostout">
<h2>Hostout</h2>
<p>As compelling as it is to write &quot;pure Python&quot; in fab files, and it is,
sometimes you just want to be done. And Hostout helps you get there. I
will explain in a minute, but first a slight detour.</p>
<div class="section" id="back-story">
<h3>Back story</h3>
<p>I recently blogged about the relaunch of this website <a class="reference external" href="http://blog.aclark.net/2011/01/19/new-website-for-2011/">here</a>. Shortly
after the launch, I realized I needed a quick and easy way to deploy my
staging site to production. I pitched the idea of a utility called
&quot;mr.pusher&quot; to accomplish this task to Dylan, with the caveat that I was
interested in making it work with Hostout.</p>
<p>As it turns out, between Hostout and a recipe I created years ago called
<a class="reference external" href="http://pypi.python.org/pypi/collective.recipe.rsync">collective.recipe.rsync</a>, &quot;mr.pusher&quot; almost already existed. Now back
to the story.</p>
</div>
<div class="section" id="fabric-integration-made-easy">
<h3>Fabric integration made easy</h3>
<p>Since I knew I wanted to be able to execute a &quot;push&quot; command remotely, I
figured I would finally get acclimated with Hostout.</p>
<p>After a small wrestling match in my head with the docs, I came up with
<a class="reference external" href="https://github.com/aclark4life/aclark_net_website/blob/master/buildout.cfg#L64">this</a>:</p>
<pre class="literal-block">
# Hostout makes Fabric integration easy
[staging]
recipe = collective.hostout
host = aclark.net
path = /srv/staging[production]
recipe = collective.hostout
host = aclark.net
path = /srv/aclark_net_website
</pre>
<p>At this point (after running buildout) I was able to perform such great
feats of remote administration (on my already-deployed-sans-hostout
sites) as:</p>
<pre class="literal-block">
$ bin/hostout staging run git pull
$ bin/hostout staging run bin/buildout -c staging.cfg
</pre>
<p>Armed with this ability, I added the following to my <a class="reference external" href="https://github.com/aclark4life/aclark_net_website/blob/master/staging.cfg">staging.cfg:</a></p>
<pre class="literal-block">
# Create scripts to deploy staging data to production.
# Be VERY careful with this. You could easily overwrite your
# live production data if you either forget to use the script
# option, or accidentally run the bin/rsync-filestorage-to-production
# script without stopping the production site first.
[filestorage-to-production]
recipe = collective.recipe.rsync
source = var/filestorage/Data.fs
target = ../aclark_net_website/var/filestorage/Data.fs
script = true[blobstorage-to-production]
recipe = collective.recipe.rsync
source = var/blobstorage/
target = ../aclark_net_website/var/blobstorage/
script = true
</pre>
<p>The result was two scripts I could use to &quot;push&quot; staging to production,
but only after stopping the production site first:</p>
<pre class="literal-block">
$ bin/hostout production run bin/supervisorctl shutdown
$ bin/hostout staging run bin/rsync-filestorage-to-production
$ bin/hostout staging run bin/rsync-blobstorage-to-production
$ bin/hostout production run bin/supervisord
</pre>
<p>And we're deployed! This technique is particularly elegant when used in
combination with a<a class="reference external" href="https://github.com/aclark4life/aclark_net_website/blob/master/apache.conf">custom 503</a>.</p>
</div>
</div>
<div class="section" id="conclusion">
<h2>Conclusion</h2>
<p>I really like this setup, and I really appreciate what Hostout gets me
&quot;for free&quot;; I didn't have to create a fabfile.py, I just configured my
staging and production host parameters in buildout.cfg and off I went.</p>
<p>Of course, there is always room for improvement. The next most logical
step for me would be to add cloud integration. If I could provision a
new Rackspace cloud server via buildout, and then host-it-out, I think
the future will have arrived. And since that is exactly what
<a class="reference external" href="http://pypi.python.org/pypi/hostout.cloud">hostout.cloud</a> appears to do, welcome to the future!</p>
<p>Alex Clark (January 2011)</p>
<p><em>Did you enjoy reading this article? Please consider `helping me help
Plone in February 2011`_.</em></p>
</div>

    </div><!-- /.entry-content -->
        <div class="comments">
      <h2>Comments !</h2>
      <div id="disqus_thread"></div>
      <script type="text/javascript">
        var disqus_identifier = "2011/01/26/hostout-rules/";
        (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'http://aclark-blog.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
      </script>
    </div>
    
  </article>
</section>
        <section id="extras" class="body">
                        <div class="blogroll">
                        <h2>links</h2>
                        <ul>
                                                    <li><a href="http://aclark.net">ACLARK.NET, LLC</a></li>
                                                </ul>
                </div><!-- /.blogroll -->
                                <div class="social">
                        <h2>social</h2>
                        <ul>
                            <li><a href="http://aclark.net/blog/feeds/all.atom.xml" type="application/atom+xml" rel="alternate">atom feed</a></li>
                            
                                                    <li><a href="http://aclark.net/blog/feeds/Django.atom.xml">atom feed (Django)</a></li>
                                                    <li><a href="http://aclark.net/blog/feeds/Mozilla.atom.xml">atom feed (Mozilla)</a></li>
                                                    <li><a href="http://aclark.net/blog/feeds/Plone.atom.xml">atom feed (Plone)</a></li>
                                                    <li><a href="http://aclark.net/blog/feeds/Python.atom.xml">atom feed (Python)</a></li>
                                                    <li><a href="http://twitter.com/aclark4life">aclark4life</a></li>
                                                    <li><a href="https://www.gittip.com/aclark4life">aclark4life (Gittip)</a></li>
                                                </ul>
                </div><!-- /.social -->
                </section><!-- /#extras -->

        <footer id="contentinfo" class="body">
                <address id="about" class="vcard body">
                Proudly powered by <a href="http://getpelican.com/">Pelican</a>, which takes great advantage of <a href="http://python.org">Python</a>.
                </address><!-- /#about -->

                <p>The theme is by <a href="http://coding.smashingmagazine.com/2009/08/04/designing-a-html-5-layout-from-scratch/">Smashing Magazine</a>, thanks!</p>
        </footer><!-- /#contentinfo -->

    <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-34988446-1']);
    _gaq.push(['_trackPageview']);
    (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
    </script>
<script type="text/javascript">
    var disqus_shortname = 'aclark-blog';
    (function () {
        var s = document.createElement('script'); s.async = true;
        s.type = 'text/javascript';
        s.src = 'http://' + disqus_shortname + '.disqus.com/count.js';
        (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
    }());
</script>
</body>
</html>